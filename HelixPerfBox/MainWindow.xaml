<Window x:Class="HelixPerfBox.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:h="http://helix-toolkit.org/wpf"
        xmlns:helixPerfBox="clr-namespace:HelixPerfBox"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        Title="MainWindow"
        Width="525"
        Height="350"
        d:DataContext="{d:DesignInstance helixPerfBox:ViewModel}"
        mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0" Orientation="Horizontal">

            <ToggleButton Content="Visible" IsChecked="{Binding IsBallsVisible}" />

            <ListBox x:Name="MaterialBox" SelectedIndex="0">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Horizontal" />
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemTemplate>
                    <DataTemplate DataType="{x:Type Material}">
                        <Ellipse Width="20"
                                 Height="20"
                                 Fill="{Binding}" />
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>

            <Button Click="OnZoomExtentsClick" Content="ZoomExtents" />
        </StackPanel>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" MinWidth="30" />
                <ColumnDefinition Width="Auto" MinWidth="30" />
                <ColumnDefinition />
            </Grid.ColumnDefinitions>
            <DataGrid AutoGenerateColumns="False"
                      ItemsSource="{Binding RedBalls}"
                      SelectedItem="{Binding SelectedRed}"
                      SelectionMode="Single"
                      SelectionUnit="FullRow">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Point3D}" Header="Point" />
                    <DataGridTextColumn Binding="{Binding Radius}" Header="Radius" />
                </DataGrid.Columns>
            </DataGrid>

            <DataGrid Grid.Column="1"
                      AutoGenerateColumns="False"
                      ItemsSource="{Binding BlueBalls}"
                      SelectionMode="Single"
                      SelectionUnit="FullRow">
                <DataGrid.Columns>
                    <DataGridTextColumn Binding="{Binding Point3D}" Header="Point" />
                    <DataGridTextColumn Binding="{Binding Radius}" Header="Radius" />
                </DataGrid.Columns>
            </DataGrid>

            <h:HelixViewport3D x:Name="Viewport3D"
                               Grid.Column="2"
                               ZoomExtentsWhenLoaded="True">
                <h:HelixViewport3D.Resources>
                    <helixPerfBox:TemplateModel x:Key="BallTemplate"
                                                DataType="{x:Type helixPerfBox:Ball}"
                                                d:DataContext="{d:DesignInstance helixPerfBox:Ball}">
                        <h:SphereVisual3D Center="{Binding Point3D}"
                                          Fill="BlueViolet"
                                          Radius="{Binding Radius}">
                            <h:SphereVisual3D.Transform>
                                <TranslateTransform3D OffsetX="{Binding Point3D.X}" />
                            </h:SphereVisual3D.Transform>
                        </h:SphereVisual3D>
                    </helixPerfBox:TemplateModel>

                    <helixPerfBox:TemplateModel x:Key="ElementNameTemplate"
                                                DataType="{x:Type helixPerfBox:Ball}"
                                                d:DataContext="{d:DesignInstance helixPerfBox:Ball}">
                        <h:SphereVisual3D Center="{Binding Point3D}"
                                          Fill="{Binding SelectedItem,
                                                         ElementName=MaterialBox}"
                                          Radius="{Binding Radius}">
                            <h:SphereVisual3D.Transform>
                                <TranslateTransform3D OffsetX="{Binding Point3D.X}" />
                            </h:SphereVisual3D.Transform>
                        </h:SphereVisual3D>
                    </helixPerfBox:TemplateModel>

                    <helixPerfBox:TemplateModel x:Key="ConverterTemplate"
                                                DataType="{x:Type helixPerfBox:Ball}"
                                                d:DataContext="{d:DesignInstance helixPerfBox:Ball}">
                        <h:SphereVisual3D Fill="BlueViolet"
                                          Radius="0.3"
                                          Transform="{Binding Point3D,
                                                              Converter={StaticResource PointToTransformConverter}}" />
                    </helixPerfBox:TemplateModel>

                    <helixPerfBox:TemplateModel x:Key="MultiBindingTemplate"
                                                DataType="{x:Type helixPerfBox:Ball}"
                                                d:DataContext="{d:DesignInstance helixPerfBox:Ball}">
                        <h:SphereVisual3D Fill="{Binding SelectedItem, ElementName=MaterialBox}">
                            <h:SphereVisual3D.Transform>
                                <MultiBinding Converter="{StaticResource PointAndRadiusToTransformConverter}">
                                    <Binding Path="Point3D" />
                                    <Binding Path="Radius" />
                                </MultiBinding>
                            </h:SphereVisual3D.Transform>
                        </h:SphereVisual3D>

                    </helixPerfBox:TemplateModel>
                </h:HelixViewport3D.Resources>
                <h:SunLight />

                <!--  <helixPerfBox:Selector3D ItemsSource="{Binding RedBalls}" SelectedItem="{Binding SelectedRed}" />  -->

                <helixPerfBox:Selector3D ItemsSource="{Binding RedBalls}" SelectedItem="{Binding SelectedRed}" />

                <!--  <helixPerfBox:ItemsControl3D ItemTemplate="{StaticResource BallTemplate}" ItemsSource="{Binding BlueBalls}" />  -->

                <!--  <helixPerfBox:ItemsControl3D ItemTemplate="{StaticResource ElementNameTemplate}" ItemsSource="{Binding BlueBalls}" />  -->

                <!--  <helixPerfBox:ItemsControl3D ItemTemplate="{StaticResource ConverterTemplate}" ItemsSource="{Binding BlueBalls}" />  -->

                <helixPerfBox:ItemsControl3D ItemTemplate="{StaticResource MultiBindingTemplate}" ItemsSource="{Binding BlueBalls}" />

                <!--  <h:SphereVisual3D x:Name="SphereVisual3D" Fill="HotPink" Radius="2"/>  -->
            </h:HelixViewport3D>
        </Grid>
    </Grid>
</Window>
